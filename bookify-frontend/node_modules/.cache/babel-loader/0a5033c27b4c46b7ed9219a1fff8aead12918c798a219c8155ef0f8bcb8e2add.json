{"ast":null,"code":"useEffect(() => {\n  const token = localStorage.getItem(\"jwt\");\n  if (!token) {\n    setError(\"No authentication token found. Redirecting to login...\");\n    setTimeout(() => window.location.href = \"/login\", 2000);\n    return;\n  }\n  axios.get(\"/api/users/me\", {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  }).then(({\n    data\n  }) => {\n    if (data.role !== \"ROLE_ADMIN\") {\n      setError(\"Unauthorized access. Redirecting to home...\");\n      setTimeout(() => window.location.href = \"/home\", 2000);\n      return;\n    }\n    // Proceed with existing data fetching\n    Promise.all([axios.get(\"/api/listings/hotels\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }), axios.get(\"/api/users\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }), axios.get(\"/api/admin/bookings\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    }), axios.get(\"/api/reviews/listing/1\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    })]).then(([listingsRes, usersRes, bookingsRes, reviewsRes]) => {\n      setListings(listingsRes.data);\n      setUsers(usersRes.data);\n      setBookings(bookingsRes.data);\n      setReviews(reviewsRes.data);\n      setLoading(false);\n    }).catch(err => {\n      setError(\"Failed to load data: \" + err.message);\n      setLoading(false);\n    });\n  }).catch(err => {\n    setError(\"Failed to verify user: \" + err.message);\n    setTimeout(() => window.location.href = \"/login\", 2000);\n  });\n}, []);","map":{"version":3,"names":["useEffect","token","localStorage","getItem","setError","setTimeout","window","location","href","axios","get","headers","Authorization","then","data","role","Promise","all","listingsRes","usersRes","bookingsRes","reviewsRes","setListings","setUsers","setBookings","setReviews","setLoading","catch","err","message"],"sources":["C:/Users/Calina/Desktop/ANUL3/sem2/SD/proiect/bookify-frontend/src/pages/AuthPage.jsx"],"sourcesContent":["useEffect(() => {\r\n  const token = localStorage.getItem(\"jwt\");\r\n  if (!token) {\r\n    setError(\"No authentication token found. Redirecting to login...\");\r\n    setTimeout(() => (window.location.href = \"/login\"), 2000);\r\n    return;\r\n  }\r\n\r\n  axios\r\n    .get(\"/api/users/me\", { headers: { Authorization: `Bearer ${token}` } })\r\n    .then(({ data }) => {\r\n      if (data.role !== \"ROLE_ADMIN\") {\r\n        setError(\"Unauthorized access. Redirecting to home...\");\r\n        setTimeout(() => (window.location.href = \"/home\"), 2000);\r\n        return;\r\n      }\r\n      // Proceed with existing data fetching\r\n      Promise.all([\r\n        axios.get(\"/api/listings/hotels\", { headers: { Authorization: `Bearer ${token}` } }),\r\n        axios.get(\"/api/users\", { headers: { Authorization: `Bearer ${token}` } }),\r\n        axios.get(\"/api/admin/bookings\", { headers: { Authorization: `Bearer ${token}` } }),\r\n        axios.get(\"/api/reviews/listing/1\", { headers: { Authorization: `Bearer ${token}` } }),\r\n      ])\r\n        .then(([listingsRes, usersRes, bookingsRes, reviewsRes]) => {\r\n          setListings(listingsRes.data);\r\n          setUsers(usersRes.data);\r\n          setBookings(bookingsRes.data);\r\n          setReviews(reviewsRes.data);\r\n          setLoading(false);\r\n        })\r\n        .catch(err => {\r\n          setError(\"Failed to load data: \" + err.message);\r\n          setLoading(false);\r\n        });\r\n    })\r\n    .catch(err => {\r\n      setError(\"Failed to verify user: \" + err.message);\r\n      setTimeout(() => (window.location.href = \"/login\"), 2000);\r\n    });\r\n}, []);"],"mappings":"AAAAA,SAAS,CAAC,MAAM;EACd,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,KAAK,CAAC;EACzC,IAAI,CAACF,KAAK,EAAE;IACVG,QAAQ,CAAC,wDAAwD,CAAC;IAClEC,UAAU,CAAC,MAAOC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAS,EAAE,IAAI,CAAC;IACzD;EACF;EAEAC,KAAK,CACFC,GAAG,CAAC,eAAe,EAAE;IAAEC,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUX,KAAK;IAAG;EAAE,CAAC,CAAC,CACvEY,IAAI,CAAC,CAAC;IAAEC;EAAK,CAAC,KAAK;IAClB,IAAIA,IAAI,CAACC,IAAI,KAAK,YAAY,EAAE;MAC9BX,QAAQ,CAAC,6CAA6C,CAAC;MACvDC,UAAU,CAAC,MAAOC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,OAAQ,EAAE,IAAI,CAAC;MACxD;IACF;IACA;IACAQ,OAAO,CAACC,GAAG,CAAC,CACVR,KAAK,CAACC,GAAG,CAAC,sBAAsB,EAAE;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAE,UAAUX,KAAK;MAAG;IAAE,CAAC,CAAC,EACpFQ,KAAK,CAACC,GAAG,CAAC,YAAY,EAAE;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAE,UAAUX,KAAK;MAAG;IAAE,CAAC,CAAC,EAC1EQ,KAAK,CAACC,GAAG,CAAC,qBAAqB,EAAE;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAE,UAAUX,KAAK;MAAG;IAAE,CAAC,CAAC,EACnFQ,KAAK,CAACC,GAAG,CAAC,wBAAwB,EAAE;MAAEC,OAAO,EAAE;QAAEC,aAAa,EAAE,UAAUX,KAAK;MAAG;IAAE,CAAC,CAAC,CACvF,CAAC,CACCY,IAAI,CAAC,CAAC,CAACK,WAAW,EAAEC,QAAQ,EAAEC,WAAW,EAAEC,UAAU,CAAC,KAAK;MAC1DC,WAAW,CAACJ,WAAW,CAACJ,IAAI,CAAC;MAC7BS,QAAQ,CAACJ,QAAQ,CAACL,IAAI,CAAC;MACvBU,WAAW,CAACJ,WAAW,CAACN,IAAI,CAAC;MAC7BW,UAAU,CAACJ,UAAU,CAACP,IAAI,CAAC;MAC3BY,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC,CACDC,KAAK,CAACC,GAAG,IAAI;MACZxB,QAAQ,CAAC,uBAAuB,GAAGwB,GAAG,CAACC,OAAO,CAAC;MAC/CH,UAAU,CAAC,KAAK,CAAC;IACnB,CAAC,CAAC;EACN,CAAC,CAAC,CACDC,KAAK,CAACC,GAAG,IAAI;IACZxB,QAAQ,CAAC,yBAAyB,GAAGwB,GAAG,CAACC,OAAO,CAAC;IACjDxB,UAAU,CAAC,MAAOC,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAS,EAAE,IAAI,CAAC;EAC3D,CAAC,CAAC;AACN,CAAC,EAAE,EAAE,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}